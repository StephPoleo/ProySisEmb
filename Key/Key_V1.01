module Key(Clk, Rst, Key_Sel, Key_Ready, Key);
//Inputs
input          Clk;
input          Rst;
input [3:0]    Key_Sel;

//Outputs
output reg     Key_Ready;
output reg     [127:0] Key;

// Constants
wire [127:0] Original_Key;


reg [31:0]    R1rot;
reg [7:0]     Rsub           [3:0];
wire [31:0]   R1C1;
wire [31:0]   R1C2;
wire [31:0]   R1C3;
wire [31:0]   R1C4;
wire [127:0]  Round1;

reg [31:0]    R2rot;
reg [7:0]     Rsub2           [3:0];
wire [31:0]   R2C1;
wire [31:0]   R2C2;
wire [31:0]   R2C3;
wire [31:0]   R2C4;
wire [127:0]  Round2;  

reg [31:0]    R3rot;
reg [7:0]     Rsub3           [3:0];
wire [31:0]   R3C1;
wire [31:0]   R3C2;
wire [31:0]   R3C3;
wire [31:0]   R3C4;
wire [127:0]  Round3;  

reg [31:0]    R4rot;
reg [7:0]     Rsub4           [3:0];
wire [31:0]   R4C1;
wire [31:0]   R4C2;
wire [31:0]   R4C3;
wire [31:0]   R4C4;
wire [127:0]  Round4;  

reg [31:0]    R5rot;
reg [7:0]     Rsub5           [3:0];
wire [31:0]   R5C1;
wire [31:0]   R5C2;
wire [31:0]   R5C3;
wire [31:0]   R5C4;
wire [127:0]  Round5;  

reg [31:0]    R6rot;
reg [7:0]     Rsub6           [3:0];
wire [31:0]   R6C1;
wire [31:0]   R6C2;
wire [31:0]   R6C3;
wire [31:0]   R6C4;
wire [127:0]  Round6;  

reg [31:0]    R7rot;
reg [7:0]     Rsub7           [3:0];
wire [31:0]   R7C1;
wire [31:0]   R7C2;
wire [31:0]   R7C3;
wire [31:0]   R7C4;
wire [127:0]  Round7;  

reg [31:0]    R8rot;
reg [7:0]     Rsub8           [3:0];
wire [31:0]   R8C1;
wire [31:0]   R8C2;
wire [31:0]   R8C3;
wire [31:0]   R8C4;
wire [127:0]  Round8;  

reg [31:0]    R9rot;
reg [7:0]     Rsub9           [3:0];
wire [31:0]   R9C1;
wire [31:0]   R9C2;
wire [31:0]   R9C3;
wire [31:0]   R9C4;
wire [127:0]  Round9; 

reg [31:0]    R10rot;
reg [7:0]     Rsub10          [3:0];
wire [31:0]   R10C1;
wire [31:0]   R10C2;
wire [31:0]   R10C3;
wire [31:0]   R10C4;
wire [127:0]  Round10;

wire R1Ready;
wire R2Ready;
wire R3Ready;
wire R4Ready;
wire R5Ready;
wire R6Ready;
wire R7Ready;
wire R8Ready;
wire R9Ready;
wire R10Ready;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
  // Program Memory will be implemented as an Asynchronous ROM
reg [7:0] Key_rom [0:15];
reg [7:0] Sbox_rom [0:255];
reg [7:0] Rcon_rom [0:63];


    
initial $readmemh("Key.dat", Key_rom,0,15); 
initial $readmemh("Sbox.dat", Sbox_rom,0,255);
initial $readmemh("Rcon.dat", Rcon_rom,0,63); 



assign Original_Key = {Key_rom[0][7:0],Key_rom[1][7:0],Key_rom[2][7:0],Key_rom[3][7:0],Key_rom[4][7:0],
Key_rom[5][7:0],Key_rom[6][7:0],Key_rom[7][7:0],Key_rom[8][7:0],Key_rom[9][7:0],Key_rom[10][7:0],
Key_rom[11][7:0],Key_rom[12][7:0],Key_rom[13][7:0],Key_rom[14][7:0],Key_rom[15][7:0]};

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else begin
        R1rot = {Key_rom[13][7:0],Key_rom[14][7:0],Key_rom[15][7:0],Key_rom[12][7:0]};
    end
end
genvar i;
generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication
        always@(posedge Clk)
        begin
            case (R1rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R1rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R1C1 = {Rsub[0] ^ Key_rom[0][7:0] ^ Rcon_rom[0][7:0],Rsub[1] ^ Key_rom[1][7:0] ^ Rcon_rom[1][7:0],Rsub[2] ^ 
Key_rom[2][7:0] ^ Rcon_rom[2][7:0],Rsub[3] ^ Key_rom[3][7:0] ^ Rcon_rom[3][7:0]};

assign R1C2 = {R1C1[31:24] ^ Key_rom[4][7:0],R1C1[23:16] ^ Key_rom[5][7:0],R1C1[15:8] ^ Key_rom[6][7:0],R1C1[7:0] ^ 
Key_rom[7][7:0]};

assign R1C3 = {R1C2[31:24] ^ Key_rom[8][7:0],R1C2[23:16] ^ Key_rom[9][7:0],R1C2[15:8] ^ Key_rom[10][7:0],R1C2[7:0] ^ 
Key_rom[11][7:0]};

assign R1C4 = {R1C3[31:24] ^ Key_rom[12][7:0],R1C3[23:16] ^ Key_rom[13][7:0],R1C3[15:8] ^ Key_rom[14][7:0],R1C3[7:0] ^ 
Key_rom[15][7:0]};

assign Round1 = {R1C1,R1C2,R1C3,R1C4};
assign R1Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if (R1Ready)begin
        R2rot = {R1C4[23:16],R1C4[15:8],R1C4[7:0],R1C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication2
        always@(posedge Clk)
        begin
            case (R2rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub2[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub2[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub2[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub2[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub2[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub2[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub2[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub2[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub2[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub2[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub2[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub2[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub2[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub2[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub2[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub2[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub2[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R2rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub2[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub2[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub2[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub2[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub2[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub2[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub2[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub2[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub2[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub2[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub2[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub2[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub2[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub2[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub2[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub2[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub2[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub2[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate

assign R2C1 = {Rsub2[0] ^ R1C1[31:24] ^ Rcon_rom[4][7:0],Rsub2[1] ^ R1C1[23:16] ^ Rcon_rom[5][7:0],Rsub2[2] ^ 
R1C1[15:8] ^ Rcon_rom[6][7:0],Rsub2[3] ^ R1C1[7:0] ^ Rcon_rom[7][7:0]};

assign R2C2 = {R2C1[31:24] ^ R1C2[31:24],R2C1[23:16] ^ R1C2[23:16],R2C1[15:8] ^ R1C2[15:8],R2C1[7:0] ^ 
R1C2[7:0]};

assign R2C3 = {R2C2[31:24] ^ R1C3[31:24],R2C2[23:16] ^ R1C3[23:16],R2C2[15:8] ^ R1C3[15:8],R2C2[7:0] ^ 
R1C3[7:0]};

assign R2C4 = {R2C3[31:24] ^ R1C4[31:24],R2C3[23:16] ^ R1C4[23:16],R2C3[15:8] ^ R1C4[15:8],R2C3[7:0] ^ 
R1C4[7:0]};

assign Round2 = {R2C1,R2C2,R2C3,R2C4};
assign R2Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if(R2Ready)begin
        R3rot = {R2C4[23:16],R2C4[15:8],R2C4[7:0],R2C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication3
        always@(posedge Clk)
        begin
            case (R3rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub3[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub3[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub3[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub3[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub3[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub3[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub3[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub3[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub3[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub3[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub3[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub3[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub3[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub3[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub3[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub3[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub3[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R3rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub3[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub3[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub3[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub3[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub3[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub3[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub3[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub3[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub3[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub3[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub3[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub3[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub3[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub3[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub3[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub3[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub3[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub3[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R3C1 = {Rsub3[0] ^ R2C1[31:24] ^ Rcon_rom[8][7:0],Rsub3[1] ^ R2C1[23:16] ^ Rcon_rom[9][7:0],Rsub3[2] ^ 
R2C1[15:8] ^ Rcon_rom[10][7:0],Rsub3[3] ^ R2C1[7:0] ^ Rcon_rom[11][7:0]};

assign R3C2 = {R3C1[31:24] ^ R2C2[31:24],R3C1[23:16] ^ R2C2[23:16],R3C1[15:8] ^ R2C2[15:8],R3C1[7:0] ^ 
R2C2[7:0]};

assign R3C3 = {R3C2[31:24] ^ R2C3[31:24],R3C2[23:16] ^ R2C3[23:16],R3C2[15:8] ^ R2C3[15:8],R3C2[7:0] ^ 
R2C3[7:0]};

assign R3C4 = {R3C3[31:24] ^ R2C4[31:24],R3C3[23:16] ^ R2C4[23:16],R3C3[15:8] ^ R2C4[15:8],R3C3[7:0] ^ 
R2C4[7:0]};

assign Round3 = {R3C1,R3C2,R3C3,R3C4};
assign R3Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if(R3Ready) begin
        R4rot = {R3C4[23:16],R3C4[15:8],R3C4[7:0],R3C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication4
        always@(posedge Clk)
        begin
            case (R4rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub4[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub4[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub4[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub4[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub4[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub4[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub4[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub4[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub4[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub4[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub4[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub4[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub4[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub4[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub4[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub4[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub4[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R4rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub4[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub4[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub4[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub4[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub4[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub4[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub4[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub4[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub4[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub4[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub4[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub4[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub4[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub4[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub4[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub4[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub4[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub4[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R4C1 = {Rsub4[0] ^ R3C1[31:24] ^ Rcon_rom[12][7:0],Rsub4[1] ^ R3C1[23:16] ^ Rcon_rom[13][7:0],Rsub4[2] ^ 
R3C1[15:8] ^ Rcon_rom[14][7:0],Rsub4[3] ^ R3C1[7:0] ^ Rcon_rom[15][7:0]};

assign R4C2 = {R4C1[31:24] ^ R3C2[31:24],R4C1[23:16] ^ R3C2[23:16],R4C1[15:8] ^ R3C2[15:8],R4C1[7:0] ^ 
R3C2[7:0]};

assign R4C3 = {R4C2[31:24] ^ R3C3[31:24],R4C2[23:16] ^ R3C3[23:16],R4C2[15:8] ^ R3C3[15:8],R4C2[7:0] ^ 
R3C3[7:0]};

assign R4C4 = {R4C3[31:24] ^ R3C4[31:24],R4C3[23:16] ^ R3C4[23:16],R4C3[15:8] ^ R3C4[15:8],R4C3[7:0] ^ 
R3C4[7:0]};

assign Round4 = {R4C1,R4C2,R4C3,R4C4};
assign R4Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if (R4Ready) begin
        R5rot = {R4C4[23:16],R4C4[15:8],R4C4[7:0],R4C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication5
        always@(posedge Clk)
        begin
            case (R5rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub5[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub5[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub5[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub5[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub5[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub5[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub5[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub5[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub5[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub5[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub5[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub5[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub5[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub5[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub5[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub5[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub5[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R5rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub5[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub5[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub5[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub5[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub5[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub5[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub5[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub5[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub5[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub5[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub5[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub5[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub5[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub5[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub5[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub5[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub5[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub5[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R5C1 = {Rsub5[0] ^ R4C1[31:24] ^ Rcon_rom[16][7:0],Rsub5[1] ^ R4C1[23:16] ^ Rcon_rom[17][7:0],Rsub5[2] ^ 
R4C1[15:8] ^ Rcon_rom[18][7:0],Rsub5[3] ^ R4C1[7:0] ^ Rcon_rom[19][7:0]};

assign R5C2 = {R5C1[31:24] ^ R4C2[31:24],R5C1[23:16] ^ R4C2[23:16],R5C1[15:8] ^ R4C2[15:8],R5C1[7:0] ^ 
R4C2[7:0]};

assign R5C3 = {R5C2[31:24] ^ R4C3[31:24],R5C2[23:16] ^ R4C3[23:16],R5C2[15:8] ^ R4C3[15:8],R5C2[7:0] ^ 
R4C3[7:0]};

assign R5C4 = {R5C3[31:24] ^ R4C4[31:24],R5C3[23:16] ^ R4C4[23:16],R5C3[15:8] ^ R4C4[15:8],R5C3[7:0] ^ 
R4C4[7:0]};

assign Round5 = {R5C1,R5C2,R5C3,R5C4};
assign R5Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if(R5Ready) begin
        R6rot = {R5C4[23:16],R5C4[15:8],R5C4[7:0],R5C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication6
        always@(posedge Clk)
        begin
            case (R6rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub6[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub6[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub6[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub6[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub6[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub6[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub6[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub6[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub6[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub6[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub6[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub6[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub6[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub6[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub6[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub6[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub6[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R6rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub6[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub6[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub6[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub6[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub6[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub6[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub6[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub6[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub6[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub6[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub6[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub6[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub6[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub6[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub6[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub6[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub6[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub6[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R6C1 = {Rsub6[0] ^ R5C1[31:24] ^ Rcon_rom[20][7:0],Rsub6[1] ^ R5C1[23:16] ^ Rcon_rom[21][7:0],Rsub6[2] ^ 
R5C1[15:8] ^ Rcon_rom[22][7:0],Rsub6[3] ^ R5C1[7:0] ^ Rcon_rom[23][7:0]};

assign R6C2 = {R6C1[31:24] ^ R5C2[31:24],R6C1[23:16] ^ R5C2[23:16],R6C1[15:8] ^ R5C2[15:8],R6C1[7:0] ^ 
R5C2[7:0]};

assign R6C3 = {R6C2[31:24] ^ R5C3[31:24],R6C2[23:16] ^ R5C3[23:16],R6C2[15:8] ^ R5C3[15:8],R6C2[7:0] ^ 
R5C3[7:0]};

assign R6C4 = {R6C3[31:24] ^ R5C4[31:24],R6C3[23:16] ^ R5C4[23:16],R6C3[15:8] ^ R5C4[15:8],R6C3[7:0] ^ 
R5C4[7:0]};

assign Round6 = {R6C1,R6C2,R6C3,R6C4};
assign R6Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if(R6Ready) begin
        R7rot = {R6C4[23:16],R6C4[15:8],R6C4[7:0],R6C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication7
        always@(posedge Clk)
        begin
            case (R7rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub7[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub7[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub7[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub7[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub7[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub7[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub7[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub7[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub7[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub7[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub7[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub7[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub7[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub7[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub7[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub7[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub7[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R7rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub7[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub7[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub7[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub7[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub7[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub7[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub7[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub7[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub7[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub7[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub7[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub7[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub7[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub7[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub7[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub7[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub7[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub7[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R7C1 = {Rsub7[0] ^ R6C1[31:24] ^ Rcon_rom[24][7:0],Rsub7[1] ^ R6C1[23:16] ^ Rcon_rom[25][7:0],Rsub7[2] ^ 
R6C1[15:8] ^ Rcon_rom[26][7:0],Rsub7[3] ^ R6C1[7:0] ^ Rcon_rom[27][7:0]};

assign R7C2 = {R7C1[31:24] ^ R6C2[31:24],R7C1[23:16] ^ R6C2[23:16],R7C1[15:8] ^ R6C2[15:8],R7C1[7:0] ^ 
R6C2[7:0]};

assign R7C3 = {R7C2[31:24] ^ R6C3[31:24],R7C2[23:16] ^ R6C3[23:16],R7C2[15:8] ^ R6C3[15:8],R7C2[7:0] ^ 
R6C3[7:0]};

assign R7C4 = {R7C3[31:24] ^ R6C4[31:24],R7C3[23:16] ^ R6C4[23:16],R7C3[15:8] ^ R6C4[15:8],R7C3[7:0] ^ 
R6C4[7:0]};

assign Round7 = {R7C1,R7C2,R7C3,R7C4};
assign R7Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if (R7Ready)begin
        R8rot = {R7C4[23:16],R7C4[15:8],R7C4[7:0],R7C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication8
        always@(posedge Clk)
        begin
            case (R8rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub8[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub8[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub8[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub8[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub8[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub8[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub8[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub8[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub8[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub8[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub8[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub8[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub8[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub8[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub8[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub8[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub8[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R8rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub8[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub8[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub8[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub8[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub8[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub8[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub8[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub8[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub8[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub8[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub8[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub8[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub8[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub8[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub8[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub8[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub8[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub8[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R8C1 = {Rsub8[0] ^ R7C1[31:24] ^ Rcon_rom[28][7:0],Rsub8[1] ^ R7C1[23:16] ^ Rcon_rom[29][7:0],Rsub8[2] ^ 
R7C1[15:8] ^ Rcon_rom[30][7:0],Rsub8[3] ^ R7C1[7:0] ^ Rcon_rom[31][7:0]};

assign R8C2 = {R8C1[31:24] ^ R7C2[31:24],R8C1[23:16] ^ R7C2[23:16],R8C1[15:8] ^ R7C2[15:8],R8C1[7:0] ^ 
R7C2[7:0]};

assign R8C3 = {R8C2[31:24] ^ R7C3[31:24],R8C2[23:16] ^ R7C3[23:16],R8C2[15:8] ^ R7C3[15:8],R8C2[7:0] ^ 
R7C3[7:0]};

assign R8C4 = {R8C3[31:24] ^ R7C4[31:24],R8C3[23:16] ^ R7C4[23:16],R8C3[15:8] ^ R7C4[15:8],R8C3[7:0] ^ 
R7C4[7:0]};

assign Round8 = {R8C1,R8C2,R8C3,R8C4};
assign R8Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if (R8Ready) begin
        R9rot = {R8C4[23:16],R8C4[15:8],R8C4[7:0],R8C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication9
        always@(posedge Clk)
        begin
            case (R9rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub9[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub9[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub9[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub9[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub9[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub9[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub9[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub9[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub9[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub9[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub9[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub9[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub9[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub9[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub9[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub9[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub9[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R9rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub9[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub9[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub9[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub9[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub9[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub9[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub9[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub9[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub9[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub9[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub9[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub9[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub9[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub9[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub9[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub9[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub9[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub9[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R9C1 = {Rsub9[0] ^ R8C1[31:24] ^ Rcon_rom[32][7:0],Rsub9[1] ^ R8C1[23:16] ^ Rcon_rom[33][7:0],Rsub9[2] ^ 
R8C1[15:8] ^ Rcon_rom[34][7:0],Rsub9[3] ^ R8C1[7:0] ^ Rcon_rom[35][7:0]};

assign R9C2 = {R9C1[31:24] ^ R8C2[31:24],R9C1[23:16] ^ R8C2[23:16],R9C1[15:8] ^ R8C2[15:8],R9C1[7:0] ^ 
R8C2[7:0]};

assign R9C3 = {R9C2[31:24] ^ R8C3[31:24],R9C2[23:16] ^ R8C3[23:16],R9C2[15:8] ^ R8C3[15:8],R9C2[7:0] ^ 
R8C3[7:0]};

assign R9C4 = {R9C3[31:24] ^ R8C4[31:24],R9C3[23:16] ^ R8C4[23:16],R9C3[15:8] ^ R8C4[15:8],R9C3[7:0] ^ 
R8C4[7:0]};

assign Round9 = {R9C1,R9C2,R9C3,R9C4};
assign R9Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

always@(posedge Clk)
begin
    if (Rst) begin
        Key_Ready = 0;        
    end
    else if (R9Ready) begin
        R10rot = {R9C4[23:16],R9C4[15:8],R9C4[7:0],R9C4[31:24]};
    end
end

generate
    for (i=0; i <= 3; i=i+1) 
    begin: replication10
        always@(posedge Clk)
        begin
            case (R10rot[31-(i*8):28-(i*8)])
                  4'b0000: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[0][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[1][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[2][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[3][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[4][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[5][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[6][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[7][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[8][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[9][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[10][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[11][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[12][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[13][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[14][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[15][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                              endcase
                           end
                  4'b0001: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[16][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[17][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[18][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[19][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[20][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[21][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[22][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[23][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[24][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[25][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[26][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[27][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[28][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[29][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[30][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[31][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                              endcase
                           end
                  4'b0010: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[32][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[33][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[34][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[35][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[36][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[37][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[38][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[39][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[40][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[41][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[42][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[43][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[44][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[45][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[46][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[47][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                              endcase             
                           end                       
                  4'b0011: begin                   
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[48][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[49][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[50][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[51][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[52][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[53][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[54][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[55][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[56][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[57][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[58][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[59][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[60][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[61][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[62][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[63][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                              endcase
                           end
                  4'b0100: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[64][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[65][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[66][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[67][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[68][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[69][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[70][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[71][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[72][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[73][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[74][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[75][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[76][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[77][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[78][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[79][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                              endcase
                           end
                  4'b0101: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[80][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[81][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[82][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[83][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[84][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[85][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[86][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[87][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[88][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[89][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[90][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[91][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[92][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[93][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[94][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[95][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                              endcase
                           end
                  4'b0110: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[96][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[97][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[98][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[99][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[100][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[101][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[102][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[103][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[104][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[105][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[106][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[107][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[108][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[109][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[110][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[111][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                              endcase
                           end
                  4'b0111: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[112][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[113][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[114][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[115][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[116][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[117][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[118][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[119][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[120][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[121][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[122][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[123][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[124][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[125][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[126][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[127][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                             endcase
                           end
                  4'b1000: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[128][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[129][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[130][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[131][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[132][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[133][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[134][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[135][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[136][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[137][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[138][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[139][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[140][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[141][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[142][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[143][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                             endcase
                           end
                  4'b1001: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[144][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[145][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[146][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[147][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[148][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[149][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[150][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[151][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[152][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[153][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[154][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[155][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[156][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[157][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[158][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[159][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                             endcase
                           end
                  4'b1010: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[160][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[161][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[162][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[163][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[164][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[165][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[166][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[167][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[168][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[169][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[170][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[171][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[172][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[173][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[174][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[175][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                             endcase
                           end
                  4'b1011: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[176][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[177][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[178][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[179][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[180][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[181][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[182][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[183][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[184][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[185][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[186][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[187][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[188][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[189][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[190][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[191][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                             endcase
                           end
                  4'b1100: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[192][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[193][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[194][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[195][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[196][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[197][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[198][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[199][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[200][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[201][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[202][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[203][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[204][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[205][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[206][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[207][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                             endcase
                           end
                  4'b1101: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[208][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[209][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[210][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[211][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[212][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[213][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[214][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[215][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[216][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[217][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[218][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[219][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[220][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[221][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[222][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[223][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                             endcase
                           end
                  4'b1110: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                    4'b0000: begin
                                                Rsub10[i] = Sbox_rom[224][7:0];
                                             end
                                    4'b0001: begin
                                                Rsub10[i] = Sbox_rom[225][7:0];
                                             end
                                    4'b0010: begin
                                                Rsub10[i] = Sbox_rom[226][7:0];
                                             end
                                    4'b0011: begin
                                                Rsub10[i] = Sbox_rom[227][7:0];
                                             end
                                    4'b0100: begin
                                                Rsub10[i] = Sbox_rom[228][7:0];
                                             end
                                    4'b0101: begin
                                                Rsub10[i] = Sbox_rom[229][7:0];
                                             end
                                    4'b0110: begin
                                                Rsub10[i] = Sbox_rom[230][7:0];
                                             end
                                    4'b0111: begin
                                                Rsub10[i] = Sbox_rom[231][7:0];
                                             end
                                    4'b1000: begin
                                                Rsub10[i] = Sbox_rom[232][7:0];
                                             end
                                    4'b1001: begin
                                                Rsub10[i] = Sbox_rom[233][7:0];
                                             end
                                    4'b1010: begin
                                                Rsub10[i] = Sbox_rom[234][7:0];
                                             end
                                    4'b1011: begin
                                                Rsub10[i] = Sbox_rom[235][7:0];
                                             end
                                    4'b1100: begin
                                                Rsub10[i] = Sbox_rom[236][7:0];
                                             end
                                    4'b1101: begin
                                                Rsub10[i] = Sbox_rom[237][7:0];
                                             end
                                    4'b1110: begin
                                                Rsub10[i] = Sbox_rom[238][7:0];
                                             end
                                    4'b1111: begin
                                                Rsub10[i] = Sbox_rom[239][7:0];
                                             end
                                    default: begin
                                                Rsub10[i] = 0;
                                             end
                             endcase
                           end
                  4'b1111: begin
                              case (R10rot[27-(i*8):24-(i*8)])
                                4'b0000: begin
                                            Rsub10[i] = Sbox_rom[240][7:0];
                                         end
                                4'b0001: begin
                                            Rsub10[i] = Sbox_rom[241][7:0];
                                         end
                                4'b0010: begin
                                            Rsub10[i] = Sbox_rom[242][7:0];
                                         end
                                4'b0011: begin
                                            Rsub10[i] = Sbox_rom[243][7:0];
                                         end
                                4'b0100: begin
                                            Rsub10[i] = Sbox_rom[244][7:0];
                                         end
                                4'b0101: begin
                                            Rsub10[i] = Sbox_rom[245][7:0];
                                         end
                                4'b0110: begin
                                            Rsub10[i] = Sbox_rom[246][7:0];
                                         end
                                4'b0111: begin
                                            Rsub10[i] = Sbox_rom[247][7:0];
                                         end
                                4'b1000: begin
                                            Rsub10[i] = Sbox_rom[248][7:0];
                                         end
                                4'b1001: begin
                                            Rsub10[i] = Sbox_rom[249][7:0];
                                         end
                                4'b1010: begin
                                            Rsub10[i] = Sbox_rom[250][7:0];
                                         end
                                4'b1011: begin
                                            Rsub10[i] = Sbox_rom[251][7:0];
                                         end
                                4'b1100: begin
                                            Rsub10[i] = Sbox_rom[252][7:0];
                                         end
                                4'b1101: begin
                                            Rsub10[i] = Sbox_rom[253][7:0];
                                         end
                                4'b1110: begin
                                            Rsub10[i] = Sbox_rom[254][7:0];
                                         end
                                4'b1111: begin
                                            Rsub10[i] = Sbox_rom[255][7:0];
                                         end
                                default: begin
                                            Rsub10[i] = 0;
                                         end
                             endcase
                           end
                  default: begin
                           Rsub10[i] = 0;
                           end
               endcase    
        end
     end
     endgenerate
        

assign R10C1 = {Rsub10[0] ^ R9C1[31:24] ^ Rcon_rom[36][7:0],Rsub10[1] ^ R9C1[23:16] ^ Rcon_rom[37][7:0],Rsub10[2] ^ 
R9C1[15:8] ^ Rcon_rom[38][7:0],Rsub10[3] ^ R9C1[7:0] ^ Rcon_rom[39][7:0]};

assign R10C2 = {R10C1[31:24] ^ R9C2[31:24],R10C1[23:16] ^ R9C2[23:16],R10C1[15:8] ^ R9C2[15:8],R10C1[7:0] ^ 
R9C2[7:0]};

assign R10C3 = {R10C2[31:24] ^ R9C3[31:24],R10C2[23:16] ^ R9C3[23:16],R10C2[15:8] ^ R9C3[15:8],R10C2[7:0] ^ 
R9C3[7:0]};

assign R10C4 = {R10C3[31:24] ^ R9C4[31:24],R10C3[23:16] ^ R9C4[23:16],R10C3[15:8] ^ R9C4[15:8],R10C3[7:0] ^ 
R9C4[7:0]};

assign Round10 = {R10C1,R10C2,R10C3,R10C4};
assign R10Ready = 1;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////
always@(posedge Clk)
begin
if (Rst) 
Key_Ready = 0;
else begin
if(R10Ready)
Key_Ready = 1;
else
Key_Ready = 0;

case (Key_Sel)
      4'b0000: begin
                  Key = Original_Key;
               end
      4'b0001: begin
                  Key = Round1;
               end
      4'b0010: begin
                  Key = Round2;
               end
      4'b0011: begin
                  Key = Round3;
               end
      4'b0100: begin
                  Key = Round4;
               end
      4'b0101: begin
                  Key = Round5;
               end
      4'b0110: begin
                  Key = Round6;
               end
      4'b0111: begin
                  Key = Round7;
               end
      4'b1000: begin
                  Key = Round8;
               end
      4'b1001: begin
                  Key = Round9;
               end
      4'b1010: begin
                  Key = Round10;
               end
      default: begin
                  Key = 0;
                        end
            endcase
end
end
endmodule
